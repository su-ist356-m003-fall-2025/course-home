{
  "hash": "1b778883e5e881681c8b7a9af60fa36e",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: '1. Introduction to Matplotlib and Seaborn'\njupyter: python3\n---\n\n*Note: Parts of this tutorial were copied from the [Syracuse University OSPO Advanced Python Workshop 2024](https://github.com/SyracuseUniversity/ospo-workshop-advpython/tree/main).*\n\nIn this tutorial you will learn the basics of how to create plots of data using\n[Seaborn](https://seaborn.pydata.org/), which depends on [Matplotlib](https://matplotlib.org/).\n\n::: {.callout-note}\nTo run this tutorial you will need both `seaborn` and `matplotlib` installed. \nSince `seaborn` depends on `matplotlib`, we only need to explicilty install\n`seaborn`; `matplotlib` will be installed along with it. To install `seaborn`,\nopen a Terminal, activate your `ist356` conda environment, and run:\n\n```{bash}\npip install seaborn\n```\n:::\n\n## Overview\n\n### Anatomy of a visualization\n\nhttps://carbondesignsystem.com/data-visualization/chart-anatomy/\n\n- Canvas / Plot Area - The area where the data is visualized.\n- Axis - The x and y lines that help to orient the viewer to the data.\n- Title - A brief description of the data being visualized.\n- Series / Trace - A single set of data that is plotted on the chart.\n- Legend - A key that explains the colors or symbols used in the visualization / series.\n\n### Data Plotting: Kinds of Data\n\n- Categorical data - Discrete values like Yes/No, Red/Green/Blue, etc.\n- Ordinal data - Categorical data that has an order to it. Monday, Tuesday, Wednesday, etc.\n- Time series data - Data that is recorded over time. Stock prices, temperature, etc.\n- Continuous data - Measuments, such as weight, height, price, etc.\n- Discrete data - Data that can only take certain values. Number of children, number of cars, etc.\n- Geospatial data - Data that is tied to a location. Latitude, Longitude, etc.\n\n## Matplotlib\n\n[Matplotlib](https://matplotlib.org/) is a multi-platform data visualization library built on NumPy arrays, and designed to work with the broader SciPy stack.\nOne of Matplotlib’s most important features is its ability to play well with many operating systems and graphics backends.\nMatplotlib supports dozens of backends and output types, which means you can count on it to work regardless of which operating system you are using or which output format you wish.\nThis cross-platform, everything-to-everyone approach has been one of the great strengths of Matplotlib.\nIt has led to a large user base, which in turn has led to an active developer base and Matplotlib’s powerful tools and ubiquity within the scientific Python world.\n\nMatplotlib is an excellent graphics library for generating scientific figures, with a slightly steeper learning curve than other libraries and a somewhat aging API, yet it is still the most widely used library for plotting in the Python community. It allows for any kind of visualization, from quick and simple to complex and custom.\nMany other libraries are built on top of Matplotlib and are designed to work in conjunction with analysis tools from the SciPy stack, such as NumPy and Pandas.\n\nAlthough you will use Seaborn most in this course (and likely outside this course)\nit is good to have a basic understanding of matplotlib. Here, we provide a very quick crash course.\n\nTo use `matplotlib`, we first need to import it. Specifically, we need to import the pyplot module, which we will rename\n`plt` (as is typical):\n\n::: {#a3f89f48 .cell execution_count=1}\n``` {.python .cell-code}\nfrom matplotlib import pyplot as plt\n```\n:::\n\n\n### Basic line plot with Matplotlib\n\nAt its most basic, matplotlib uses \"figures\" and \"axes\". These create the canvases that you can plot things on.\nAn axes is what a plot is created on; a figure can hold one or more axes. To create them:\n\n::: {#17940305 .cell execution_count=2}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.add_subplot()\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-3-output-1.png){width=581 height=416}\n:::\n:::\n\n\nOk, so how do we actually make a plot? Let's create a simple line plot of a sine wave, evaluated between 0 and 2pi.\nFirst, we'll create our data with numpy:\n\n::: {#7acad743 .cell execution_count=3}\n``` {.python .cell-code}\nimport numpy as np\nx = np.linspace(0, 2*np.pi, 100)\ny = np.sin(x)\n```\n:::\n\n\nNow let's create a figure, axes, and plot them using the `plot` function:\n\n::: {#14a14ad7 .cell execution_count=4}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.add_subplot()\nax.plot(x, y)\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-5-output-1.png){width=590 height=411}\n:::\n:::\n\n\nNote that the plotting function is a method of the axes. We can make a nicer looking plot by adding things\nlike axis labels, a legend, and an axis label:\n\n::: {#37e96283 .cell execution_count=5}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.add_subplot()\nax.plot(x, y, label='sin(x)$')\nax.set_xlabel('x')\nax.set_ylabel('y')\nax.legend()\nax.grid()\nax.set_title('My plot')\n```\n\n::: {.cell-output .cell-output-display execution_count=5}\n```\nText(0.5, 1.0, 'My plot')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-6-output-2.png){width=608 height=449}\n:::\n:::\n\n\nWe can also plot more than one thing on a single plot. Let's plot cos(x) on the same plot:\n\n::: {#2887497c .cell execution_count=6}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.add_subplot()\nax.plot(x, y, label='sin(x)')\nax.plot(x, np.cos(x), label='cos(x)')\nax.set_xlabel('x')\nax.set_ylabel('y')\nax.legend()\nax.grid()\nax.set_title('My plot')\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\nText(0.5, 1.0, 'My plot')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-7-output-2.png){width=608 height=449}\n:::\n:::\n\n\nNotice that the color of the second plot automatically changed. You can alternatively\nspecify the color manually using the `color` argument in `plot`. You can also do things\nlike set the linestyle and linewidth. For example:\n\n::: {#73f63623 .cell execution_count=7}\n``` {.python .cell-code}\nfig = plt.figure()\nax = fig.add_subplot()\nax.plot(x, y, lw=2, label='sin(x)')\nax.plot(x, np.cos(x), lw=2, ls='--', label='cos(x)')\nax.set_xlabel('x')\nax.set_ylabel('y')\nax.legend()\nax.grid()\nax.set_title('My plot')\n```\n\n::: {.cell-output .cell-output-display execution_count=7}\n```\nText(0.5, 1.0, 'My plot')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-8-output-2.png){width=608 height=449}\n:::\n:::\n\n\n### Stateful execution\n\nIn the above examples we explicitly created a figure, axes, and added plots to the axes.\n\nMatplotlib has another, \"stateful\", interface. In this case, the figure and axes are automatically\ncreated and managed by matplotlib in the background. Instead of calling methods, you instead call\nmethods on the `pyplot` module directly. Here's the same example as above, but using the stateful\ninterface:\n\n::: {#1de219f2 .cell execution_count=8}\n``` {.python .cell-code}\nplt.plot(x, y, lw=2, label='sin(x)')\nplt.plot(x, np.cos(x), lw=2, ls='--', label='cos(x)')\nplt.xlabel('x')\nplt.ylabel('y')\nplt.legend()\nplt.grid()\nplt.title('My plot')\n```\n\n::: {.cell-output .cell-output-display execution_count=8}\n```\nText(0.5, 1.0, 'My plot')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-9-output-2.png){width=608 height=449}\n:::\n:::\n\n\nNotice that in this case you don't interact with the figure or axes at all. Instead, matplotlib\ncreates the a figure and axes for you, which are the \"current\" figure/axes. All plotting commands\nare automatically added to those plots. You can retrieve the current figure and axes with:\n\n::: {#904a1753 .cell execution_count=9}\n``` {.python .cell-code}\n# get the current figure\nfig = plt.gcf()\n# get the current axes\naxes = plt.gca()\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-10-output-1.png){width=581 height=416}\n:::\n:::\n\n\nAs you can see, the stateful interface can be quicker and easier to use if you are only creating\na single plot at a time. It is the more common interface you will see in various examples on the\nweb. Seaborn also supports a stateful interface that we will use below.\n\nHowever, I prefer directly interacting with the figure and axes as we did initially. This causes\nless confusion later on, and it makes it easy to create more complicated figures with multiple\naxes. What to use is up to you, and it depends on the situation.\n\n## Seaborn\n\n[Seaborn](https://seaborn.pydata.org/) is a Python data visualization library based on Matplotlib. It provides a high-level interface for drawing attractive and informative statistical graphics.\n\nConsider seaborn as a replacement for Matplotlib, Pythons de-facto plotting library. Seaborn is built on top of Matplotlib and closely integrated with pandas data structures. You can think of Matplotlib and Seaborn as being to visualization\nas numpy and Pandas is to data wrangling.\n\nTo use Seaborn, we need to import it:\n\n::: {#7266e0b0 .cell execution_count=10}\n``` {.python .cell-code}\nimport seaborn as sns\n```\n:::\n\n\n## Datasets we will use\n\nSeaborn has some in-built toy datasets that we will use to illustrate its plotting capabilities.\n\n- \"penguins\" The Palmer Penguins dataset: https://github.com/allisonhorst/palmerpenguins\n- \"dowjones\": The Dow Jones Industrial Stock Price Index: https://fred.stlouisfed.org/series/M1109BUSM293NNBR\n\nWe will also use:\n- Analyzing Mobile Usage Patterns and User Behavior Classification Across Devices https://www.kaggle.com/datasets/valakhorasani/mobile-device-usage-and-user-behavior-dataset\n\n## Plot Types\n\n### Line plot\n\nTo start, let's recreate the simple line plot we did above with matplotlib:\n\n::: {#584a673d .cell execution_count=11}\n``` {.python .cell-code}\nlp = sns.lineplot(x=x, y=y, label='sin(x)')\nsns.lineplot(x=x, y=np.cos(x), lw=2, ls='--', label='cos(x)')\nlp.set_xlabel('x')\nlp.set_ylabel('y')\nlp.legend()\nlp.grid()\nlp.set_title('My plot')\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\nText(0.5, 1.0, 'My plot')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-12-output-2.png){width=608 height=449}\n:::\n:::\n\n\nThat's nice, but not that much better than the matplotlib interface. Where Seaborn really shines is its\ninterface with Pandas. For example, let's create a DataFrame from x and sin(x):\n\n::: {#ba3d7ea4 .cell execution_count=12}\n``` {.python .cell-code}\nimport pandas as pd\ndf = pd.DataFrame({'x': x, 'sin(x)': np.sin(x)})\nsns.lineplot(data=df, x='x', y='sin(x)')\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-13-output-1.png){width=608 height=429}\n:::\n:::\n\n\nNotice that an x and y label were generated automatically for us. Things get even more interesting\nif you use the `hue` argument. Suppose we have dataframe that has both sin and cos values in a single\ncolumn, with a separate column that indicates which rows below to which function:\n\n::: {#235bfebb .cell execution_count=13}\n``` {.python .cell-code}\ndf = pd.DataFrame({'x': np.tile(x, 2), 'Trig Functions': np.append(np.sin(x), np.cos(x)),\n                   'Function': ['sin']*len(x) + ['cos']*len(x)})\nprint(df.head())\nprint(df.tail())\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n          x  Trig Functions Function\n0  0.000000        0.000000      sin\n1  0.063467        0.063424      sin\n2  0.126933        0.126592      sin\n3  0.190400        0.189251      sin\n4  0.253866        0.251148      sin\n            x  Trig Functions Function\n195  6.029319        0.967949      cos\n196  6.092786        0.981929      cos\n197  6.156252        0.991955      cos\n198  6.219719        0.997987      cos\n199  6.283185        1.000000      cos\n```\n:::\n:::\n\n\nNow we can plot both with a single line, using the `hue` argument:\n\n::: {#d6949ee5 .cell execution_count=14}\n``` {.python .cell-code}\nsns.lineplot(data=df, x='x', y='Trig Functions', hue='Function')\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-15-output-1.png){width=608 height=429}\n:::\n:::\n\n\nNotice that it created x and y labels, as well as a legend for us! The `hue` parameter\nis especially useful for bar plots, as we'll see below.\n\n## Errorbar\n\nSeaborn also makes it easy to create plots with errorbars on it. To illustrate, let's use\nthe Dow Jones Industrial data:\n\n::: {#875ea2ba .cell execution_count=15}\n``` {.python .cell-code}\ndow = sns.load_dataset(\"dowjones\")\ndow.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=15}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Date</th>\n      <th>Price</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>1914-12-01</td>\n      <td>55.00</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>1915-01-01</td>\n      <td>56.55</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>1915-02-01</td>\n      <td>56.00</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>1915-03-01</td>\n      <td>58.30</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>1915-04-01</td>\n      <td>66.45</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 1.1\n\nMake a line plot of the Dow price versus year using Seaborn.\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n::: {#81c796b5 .cell execution_count=16}\n``` {.python .cell-code}\nsns.lineplot(data=dow, x=\"Date\", y=\"Price\")\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-17-output-1.png){width=604 height=429}\n:::\n:::\n\n\n:::\n::::\n\nNow suppose we want to average the price per year. First, let's create a new column\nthat just has the year. To do that, we'll create a function that extracts the year from\nthe Date column:\n\n::: {#2893a917 .cell execution_count=17}\n``` {.python .cell-code}\ndef parse_year(date):\n    return date.year\n```\n:::\n\n\nNow apply it:\n\n::: {#67473cc0 .cell execution_count=18}\n``` {.python .cell-code}\nyears = dow['Date'].apply(parse_year)\ndow['Year'] = years\n```\n:::\n\n\nNow let's plot it:\n\n::: {#89d63463 .cell execution_count=19}\n``` {.python .cell-code}\nlp = sns.lineplot(data=dow, x=\"Year\", y=\"Price\", estimator='mean')\nlp.set_title(\"Average Dow Jones Price by Year\")\n```\n\n::: {.cell-output .cell-output-display execution_count=19}\n```\nText(0.5, 1.0, 'Average Dow Jones Price by Year')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-20-output-2.png){width=604 height=449}\n:::\n:::\n\n\nSeaborn has shown the average for each year, and has automatically added errorbars\nshowing the standard deviation for each year.\n\n## The Bar Plot\n\nA bar plot is a plot that presents categorical data with rectangular bars with lengths proportional to the coninouos or discrete values they represent.  One axis of the plot shows the specific categories being compared, and the other axis represents a measured value.\n\nSeaborn will automatically aggregate the data for you, using the `estimator` named argument. It takees the values `\"mean\", \"count\", \"sum\", \"min\"` or `\"max\"`.\n\nTo illustrate this, we will use the Palmer Penguins data:\n\n::: {#2c88c035 .cell execution_count=20}\n``` {.python .cell-code}\nimport seaborn as sns\npengo = sns.load_dataset(\"penguins\")\npengo.head()\n```\n\n::: {.cell-output .cell-output-display execution_count=20}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>species</th>\n      <th>island</th>\n      <th>bill_length_mm</th>\n      <th>bill_depth_mm</th>\n      <th>flipper_length_mm</th>\n      <th>body_mass_g</th>\n      <th>sex</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.1</td>\n      <td>18.7</td>\n      <td>181.0</td>\n      <td>3750.0</td>\n      <td>Male</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>39.5</td>\n      <td>17.4</td>\n      <td>186.0</td>\n      <td>3800.0</td>\n      <td>Female</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>40.3</td>\n      <td>18.0</td>\n      <td>195.0</td>\n      <td>3250.0</td>\n      <td>Female</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n      <td>NaN</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Adelie</td>\n      <td>Torgersen</td>\n      <td>36.7</td>\n      <td>19.3</td>\n      <td>193.0</td>\n      <td>3450.0</td>\n      <td>Female</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\nEach row in the data set represents measurements for a single penguin. Let's make that more explicit by adding\na \"count\" column, which we'll use to keep track of the number of penguins in the dataset.\n\n::: {#28996ac6 .cell execution_count=21}\n``` {.python .cell-code}\npengo['count'] = 1\n```\n:::\n\n\nNow lets create a bar plot showing the total number of penguins by species. To separate them out, we'll use the\n`hue` argument:\n\n::: {#4a5ff6f2 .cell execution_count=22}\n``` {.python .cell-code}\nplot = sns.barplot(data=pengo, x=\"species\", y=\"count\", hue=\"species\", estimator=\"sum\")\nplot.set_title(\"Penguin species count\")\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```\nText(0.5, 1.0, 'Penguin species count')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-23-output-2.png){width=593 height=449}\n:::\n:::\n\n\n### Same plot with method chaning\n\nYou can chain the title onto the plot.\n\n::: {#fc2178cc .cell execution_count=23}\n``` {.python .cell-code}\nsns.barplot(data=pengo, x=\"species\", y=\"count\", hue=\"species\", estimator=\"sum\").set_title(\"Penguin species count\")\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```\nText(0.5, 1.0, 'Penguin species count')\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-24-output-2.png){width=593 height=449}\n:::\n:::\n\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 1.2\n\nUsing the Palmer penguins data, make a bar plot of body mass (y axis) vs species (x axis) , separated by sex.\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n::: {#29763c44 .cell execution_count=24}\n``` {.python .cell-code}\nsns.barplot(data=pengo, x=\"species\", y=\"body_mass_g\", hue=\"sex\", estimator=\"mean\")\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-25-output-1.png){width=601 height=429}\n:::\n:::\n\n\n:::\n::::\n\n\n### Scatter plots\n\nA scatter plot is used to show how to variables are related to each other. This is usually used when there is\nsome random element to the data such that the realtionship between the variables is not always one-to-one.\nIn that case, you don't want to make a line plot, as the lines will jumpt around, making for a difficult\nto read plot. A scatter plot simply puts markers at every data point, so that you can get a sense of\nwhat the relationship between the variables are.\n\nTo make a scatter plot with Seaborn you use the [scatterplot](https://seaborn.pydata.org/generated/seaborn.scatterplot.html)\nfunction. For example, here is a scatter plot showing the relationship between\nbill length and flipper length in the Palmer penguins dataset:\n\n::: {#088ea714 .cell execution_count=25}\n``` {.python .cell-code}\nsns.scatterplot(data=pengo, x='bill_length_mm', y='flipper_length_mm')\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-26-output-1.png){width=593 height=429}\n:::\n:::\n\n\nWe can make an even more informative plot with the hue argument to color the points based on\none of the other columns. If we make the hue be based on species, we get:\n\n::: {#546eed51 .cell execution_count=26}\n``` {.python .cell-code}\nsns.scatterplot(data=pengo, x='bill_length_mm', y='flipper_length_mm', hue='species')\n```\n\n::: {.cell-output .cell-output-display}\n![](visualization-1_files/figure-html/cell-27-output-1.png){width=593 height=429}\n:::\n:::\n\n\nNotice that changing the colors of the markers based on a third column, we have effectively\nrepresented 3D data in a 2D plot.\n\n",
    "supporting": [
      "visualization-1_files/figure-html"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js\" integrity=\"sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js\" integrity=\"sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2\" crossorigin=\"anonymous\" data-relocate-top=\"true\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}