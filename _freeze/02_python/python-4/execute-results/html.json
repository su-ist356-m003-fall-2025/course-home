{
  "hash": "aed82f5f6a9f2ae15b38c7948122e8c2",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: '4. Modules, import, pip, testing'\njupyter: python3\n---\n\n# Modules and Packages\n\n- A **Module** is a file containing Python code. \n- The Code in the module can be included in your code using the `import` command\n- A collection of modules bundled for re-distribution is known as a **Package**\n\n## Built in Modules vs. External\n\n- The Python language has several modules which are included with the base language: **Python Standard Library** https://docs.python.org/3/library/ \n- In addition you can import other libraries found on the Internet. \n- The Python Package Index is a website which allows you to search for other code avaialbe for use. https://pypi.org/\n- Once you know which package you want, **you can install it with the `pip` command from the terminal.**\n- Example: `pip install <name-of-package>` (Make sure you activate your conda environment first!)\n- You can also install packages using conda. For example, `conda install -c conda-forge <name-of-package>`.\n- Which to use? Basically, `conda` and `pip` can be used interchangeably within a conda environment. Some packages may be in PyPI that are not in conda-forge and vice versa.\n\n## Requirements.txt\n\n- `requirements.txt` is a file which stores the names of all the packages a project uses\n- adding them to the file is a replacement for installing each of them manually\n- to install the packages: `pip install -r requirements.txt`\n\n## Importing Modules \n\nCode in the module can be included in your code using the `import` command. There are a few different ways to import some code:\n\n- `import foo` imports code from module `foo`. Functions in that module can then be referenced in the current code by prefixing the function with `foo.`. For example, if `foo` has a function `bar` defined in it, then after the `import foo` statement you can use the `bar` function by writing `foo.bar(...)` (where the `...` indicate the arguments you need to pass to `bar`).\n- `from foo import bar,baz` only imports the `bar` and `baz` functions from module `foo`. When imported in this manner, the `bar` and `baz` functions are referenced directly, without the module prefix. For example, in this case, to execute the bar function, you run `bar(...)` instead of `foo.bar(...)`.\n\n:::: {.callout-note appearance=\"simple\" icon=\"false\"}\n### Concept check \n\nWhat's wrong with the following code?\n\n::: {#eb9dd835 .cell execution_count=1}\n``` {.python .cell-code}\nexp = 'Dear {name}, we would like to express our gratitude for your donation!'\n\nfrom math import exp\n\nprint(exp.format(name=\"Jeff\"))\n```\n:::\n\n\n::: {.callout-note collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\nThe `from math import exp` line will cause the `exp` variable in the namespace that's defined in the first line to be replaced by the exponential function in the math module. This will cause an error in the last line, which expects `exp` to be a string, not a function.\n\n:::\n::::\n\n- **Renaming imports**: You can avoid namespace collisions by renaming an imported module or functions via: `import foo as f`. For example, in the Concept check above, doing `from math import exp as mathexp` would avoid the error.\n\n\n## Whats in the module?\n\n- Use the `dir(<module>)` to list the functions in the module\n- Use `help(module.function)` to get the docstring for a function in a module.\n\n::: {#d2958567 .cell tags='[]' execution_count=2}\n``` {.python .cell-code}\n# Examples\nimport math\n```\n:::\n\n\n::: {#f9151f04 .cell tags='[]' execution_count=3}\n``` {.python .cell-code}\n# get the functions\ndir(math)\n```\n\n::: {.cell-output .cell-output-display execution_count=2}\n```\n['__doc__',\n '__file__',\n '__loader__',\n '__name__',\n '__package__',\n '__spec__',\n 'acos',\n 'acosh',\n 'asin',\n 'asinh',\n 'atan',\n 'atan2',\n 'atanh',\n 'cbrt',\n 'ceil',\n 'comb',\n 'copysign',\n 'cos',\n 'cosh',\n 'degrees',\n 'dist',\n 'e',\n 'erf',\n 'erfc',\n 'exp',\n 'exp2',\n 'expm1',\n 'fabs',\n 'factorial',\n 'floor',\n 'fma',\n 'fmod',\n 'frexp',\n 'fsum',\n 'gamma',\n 'gcd',\n 'hypot',\n 'inf',\n 'isclose',\n 'isfinite',\n 'isinf',\n 'isnan',\n 'isqrt',\n 'lcm',\n 'ldexp',\n 'lgamma',\n 'log',\n 'log10',\n 'log1p',\n 'log2',\n 'modf',\n 'nan',\n 'nextafter',\n 'perm',\n 'pi',\n 'pow',\n 'prod',\n 'radians',\n 'remainder',\n 'sin',\n 'sinh',\n 'sqrt',\n 'sumprod',\n 'tan',\n 'tanh',\n 'tau',\n 'trunc',\n 'ulp']\n```\n:::\n:::\n\n\n::: {#c9184c17 .cell tags='[]' execution_count=4}\n``` {.python .cell-code}\nhelp(math.pow)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHelp on built-in function pow in module math:\n\npow(x, y, /)\n    Return x**y (x to the power of y).\n\n```\n:::\n:::\n\n\n::: {#5f9dbf4e .cell tags='[]' execution_count=5}\n``` {.python .cell-code}\nmath.pow(2,5) # 2*2*2*2*2\n```\n\n::: {.cell-output .cell-output-display execution_count=4}\n```\n32.0\n```\n:::\n:::\n\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 4.1\n\nUse the `datetime` module to parse a \"Month/Day/Year\" string (e.g., \"9/15/2025\") into a datetime then print it in YYYY-MM-DD format (e.g., \"2025-09-15\"). \n\nYou will need to read through the module with `dir()` and `help()` or read the python docs to determine which functions to use.\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n::: {#c8ae0c3e .cell execution_count=6}\n``` {.python .cell-code}\nfrom datetime import datetime\n\ntext = input(\"Enter date m/d/y: \")\nnow = datetime.strptime(text, \"%m/%d/%Y\")\nnowstr = now.strftime(\"%Y-%m-%d\")\nprint(nowstr)\n```\n:::\n\n\n:::\n::::\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 4.2\n\nLet's make the code in Challenge 4.2 more resusable:\n\n1.  Re-write the date parse into a function `parsedate_mdy(text: str) -> datetime:`.\n\n1.  Re-write the date format into a function `formatdate_ymd(date: datetime) -> str:`. \n\n1.  Re-write the main program to use both functions. input -> parsedate -> formatdate -> output\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n::: {#6b363cba .cell execution_count=7}\n``` {.python .cell-code}\nfrom datetime import datetime\n\ndef parsedate_mdy(text: str) -> datetime:\n    dt = datetime.strptime(text, \"%m/%d/%Y\")\n    return dt\n\n\ndef formatdate_ymd(date: datetime) -> str:\n    return date.strftime(\"%Y-%m-%d\")\n\n\ntext = input(\"Enter date m/d/y: \")\ndate = parsedate_mdy(text)\ndate_str = formatdate_ymd(date)\nprint(date_str)\n```\n:::\n\n\n:::\n::::\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 4.3\n\nLet's make the code in Challenge 4.2 even more resusable!\n\n1.  Move your functions into a module name `dateutils.py`.\n\n1.  Import your functions from `dateutils.py` into `4-3.py`\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n1.  Create the `dateutils.py` file in VS Code by clicking \"File\" -> \"New File\". Name it `dateutils.py`. Then copy the functions you wrote in Challenge 4.2 into it (don't forget the `from datetime import datetime` at the top!). Save the file by typing CTRL/CMD + S or clicking File -> Save.\n\n1.  To use your functions in a notebook or another python script:\n\n\n    ::: {#87bd0d78 .cell execution_count=8}\n    ``` {.python .cell-code}\n    from dateutils import parsedate_mdy, formatdate_ymd\n    \n    text = input(\"Enter date m/d/y: \")\n    date = parsedate_mdy(text)\n    date_str = formatdate_ymd(date)\n    print(date_str)\n    ```\n    :::\n    \n    \n:::\n::::\n\n::: {.callout-important}\n## Avoid wildcard imports!\n\nIt's possible to use a wildcard `*` when importing. For example,\n\n::: {#76b23f8c .cell execution_count=9}\n``` {.python .cell-code}\nfrom math import *\n```\n:::\n\n\nwill import all functions that are in the math module into the current namespace. This means that you could then call `math.pow` with just `pow`, for example.\n\n**Don't do this!** The problem with this is you can accidentally override variables in your program without realizing it. For example, if you defined a variable called `e` then did `from math import *`, `e` would be replaced with the value of the natural exponent, since `e` is defined in the `math` module. Doing wildcard imports also makes it difficult to debug code, since it's a challenge to determine what module a particular variable came from. Wildcard imports should only be used in very limited situations, which you are unlikely to run in to. Long story short... **don't use wildcard imports!** I only tell you about it in case you see it in the wild (no pun intended).\n\n:::\n\n\n# Testing Your Code\n\n- For every function you write you should get in the habit of writing code to test the function\n- We want this to be automated so that we can easily determine if a change to our code has affected other code\n- This is especially useful with large projects\n\n## Assert\n\n`assert` is a python command which throws an exception if the expression asserted is false.\n\nWhen an `assert` fails, it raises an `AssertionError` exception  which alerts us that something did not go as planned.\n\n::: {#45c52bf6 .cell tags='[]' execution_count=10}\n``` {.python .cell-code}\nassert 1 + 1 == 2   # This is true, no worries\n```\n:::\n\n\n::: {#629619ea .cell execution_count=11}\n``` {.python .cell-code}\nassert 2 + 2 == 5 # False AssertionError\n```\n\n::: {.cell-output .cell-output-error}\n\n::: {.ansi-escaped-output}\n```{=html}\n<pre><span class=\"ansi-red-fg\">---------------------------------------------------------------------------</span>\n<span class=\"ansi-red-fg\">AssertionError</span>                            Traceback (most recent call last)\n<span class=\"ansi-cyan-fg\">Cell</span><span class=\"ansi-cyan-fg\"> </span><span class=\"ansi-green-fg\">In[6]</span><span class=\"ansi-green-fg\">, line 1</span>\n<span class=\"ansi-green-fg\">----&gt; </span><span class=\"ansi-green-fg\">1</span> <span style=\"font-weight:bold;color:rgb(0,135,0)\">assert</span> <span class=\"ansi-green-fg\">2</span> + <span class=\"ansi-green-fg\">2</span> == <span class=\"ansi-green-fg\">5</span> <span style=\"font-style:italic;color:rgb(95,135,135)\"># False AssertionError</span>\n\n<span class=\"ansi-red-fg\">AssertionError</span>: </pre>\n```\n:::\n\n:::\n:::\n\n\n## Pytest\n\n[Pytest](https://docs.pytest.org/en/stable/index.html) is testing framework for Python. It can automatically discover tests in your code; for example, any function that starts with `test` is executed when you invoke pytest. (See [here](https://docs.pytest.org/en/stable/explanation/goodpractices.html#conventions-for-python-test-discovery) for the full list of rules that `pytest` uses to discover test functions.)\n\nYou can invoke it at the terminal like this:\n\n`python -m pytest <filetotest>`\n\n::: {.callout-note}\n\nPytest is not installed by default when you create a new conda environment. If you have not installed `pytest` into your `ist356` environment yet, you can do so by opening a terminal and running:\n\n```bash\nconda activate ist356\npip install pytest\n```\n\n:::\n\nThe VS Code test plugin should discover the tests.\n\n:::: {.callout-caution appearance=\"simple\" icon=\"false\"}\n### Code Challenge 4.4\n\nWrite a \"round robin\" test that tests the `parsedate_mdy` and `formatdate_ymd` functions you wrote in Code Challenge 4.3. The test should start with a known input, run the two functions on it, then check if it yields the known output.\n\nRun pytest or VS Code test to make sure your tests pass!\n\n::: {.callout-caution collapse=\"true\" appearance=\"simple\" icon=\"false\"}\n#### Solution\n\n1.  Add the following to `dateutils.py`:\n\n::: {#faabac8b .cell execution_count=12}\n``` {.python .cell-code}\n#! eval: false\ndef test_round_robin():\n    date_str = \"9/15/2025\"\n    date_obj = parsedate_mdy(date_str)\n    assert formatdate_ymd(date_obj) == \"2025-09-15\"\n```\n:::\n\n\n2.  To run the test, open a terminal (in VS Code, select Terminal -> New Terminal). If your `ist356` conda environment is not active, activate it by running: `conda activate ist356`. Now `cd` into the directory that `dateutils.py` is in (you're probably already there; run `ls` to check), then run:\n\n```bash\npython -m pytest dateutils.py\n```\n\nNote: if you not have installed pytest in your environment yet you will get an error `No module named pytest`. In that case, install `pytest` by either running `pip install pytest` or `conda install -c conda-forge -y pytest`.\n\n:::\n::::\n\n",
    "supporting": [
      "python-4_files/figure-html"
    ],
    "filters": [],
    "includes": {}
  }
}