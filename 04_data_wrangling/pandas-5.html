<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>6. Grouping data and creating pivot tables with Pandas – IST 356 Fall 2025</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../05_web_apis/index.html" rel="next">
<link href="../04_data_wrangling/pandas-4.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-636770ed70550effe8cc9e61b03b729c.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdn.jsdelivr.net/npm/requirejs@2.3.6/require.min.js" integrity="sha384-c9c+LnTbwQ3aujuU7ULEPVvgLs+Fn6fJUvIGTsuu1ZcCf11fiEubah0ttpca4ntM sha384-6V1/AdqZRWk1KAlWbKBlGhN7VG4iE/yAZcO6NZPMF8od0vukrvr0tg4qY6NSrItx" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<meta property="og:title" content="6. Grouping data and creating pivot tables with Pandas – IST 356 Fall 2025">
<meta property="og:description" content="">
<meta property="og:image" content="enter_gitHub_pages_URL_here/04_data_wrangling/challenge-6_2-example.png">
<meta property="og:site_name" content="IST 356 Fall 2025">
<meta property="og:image:height" content="1296">
<meta property="og:image:width" content="1584">
<meta name="twitter:title" content="6. Grouping data and creating pivot tables with Pandas – IST 356 Fall 2025">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="enter_gitHub_pages_URL_here/04_data_wrangling/challenge-6_2-example.png">
<meta name="twitter:image-height" content="1296">
<meta name="twitter:image-width" content="1584">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">IST 356 Fall 2025</span>
    </a>
  </div>
          <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://ischool.syracuse.edu" target="_blank"> 
<span class="menu-text"><img src="../images/ischool_logo_reverseX2.png" height="30"></span></a>
  </li>  
</ul>
          <div class="quarto-navbar-tools">
</div>
            <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04_data_wrangling/index.html">4. Data Wrangling</a></li><li class="breadcrumb-item"><a href="../04_data_wrangling/pandas-5.html">6. Grouping data and creating pivot tables with Pandas</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../00_intro/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction and computer setup</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../01_cli_conda/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Command line interface and Environments</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_cli_conda/shell-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Command Line Interface and the Unix Shell</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01_cli_conda/conda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Bash variables, environments, and <code>conda</code></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../02_python/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Python review</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_python/python-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Input, output, variables, types, conditionals</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_python/python-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Iterations, lists, dictionaries, comprehensions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_python/python-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Functions, documentation, strings, files</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../02_python/python-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Modules, import, pip, testing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../03_ui/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. UI</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_ui/ui-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Interaction in Jupyter using ipywidgets</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../03_ui/ui-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Creating simple web apps with Streamlit</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../04_data_wrangling/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Data Wrangling</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/numpy_basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction to NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/pandas-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Introduction to Pandas: Series and DataFrames</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/pandas-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Data I/O with Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/pandas-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">4. Joining Multiple Pandas Dataframes</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/pandas-4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Basic data cleaning with Pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../04_data_wrangling/pandas-5.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">6. Grouping data and creating pivot tables with Pandas</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../05_web_apis/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">5. Web APIs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_web_apis/webapi-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. REST APIs</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_web_apis/webapi-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. Posting with REST API and caching results</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../05_web_apis/webapi-3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">3. Creating your own APIs with FastAPI</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="../06_web_scraping/index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">6. Web Scraping</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_web_scraping/scraping-1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">1. Introduction to Web Scraping</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../06_web_scraping/scraping-2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">2. More Scraping + actionability</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../syllabus.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Syllabus</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#group-by" id="toc-group-by" class="nav-link active" data-scroll-target="#group-by">Group By</a></li>
  <li><a href="#pivot-and-melt" id="toc-pivot-and-melt" class="nav-link" data-scroll-target="#pivot-and-melt">Pivot and Melt</a>
  <ul class="collapse">
  <li><a href="#pivot" id="toc-pivot" class="nav-link" data-scroll-target="#pivot">Pivot()</a></li>
  <li><a href="#melt" id="toc-melt" class="nav-link" data-scroll-target="#melt">Melt()</a></li>
  </ul></li>
  <li><a href="#pivot_table" id="toc-pivot_table" class="nav-link" data-scroll-target="#pivot_table">Pivot_table()</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../04_data_wrangling/index.html">4. Data Wrangling</a></li><li class="breadcrumb-item"><a href="../04_data_wrangling/pandas-5.html">6. Grouping data and creating pivot tables with Pandas</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">6. Grouping data and creating pivot tables with Pandas</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>In this lesson you will learn how to group data together in a DataFrame and create summary statistics of the grouped data. You will also learn how to reshape a DataFrame, and create a pivot table.</p>
<p>For this lesson we will use the following data of (fake) exam scores:</p>
<div id="b5f34073" class="cell" data-execution_count="1">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>exams_data <span class="op">=</span> <span class="st">'https://raw.githubusercontent.com/mafudge/datasets/refs/heads/master/exam-scores/exam-scores.csv'</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>exams <span class="op">=</span> pd.read_csv(exams_data)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>exams.sample(<span class="dv">10</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="1">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">Completion_Time</th>
<th data-quarto-table-cell-role="th">Made_Own_Study_Guide</th>
<th data-quarto-table-cell-role="th">Did_Exam_Prep Assignment</th>
<th data-quarto-table-cell-role="th">Studied_In_Groups</th>
<th data-quarto-table-cell-role="th">Student_Score</th>
<th data-quarto-table-cell-role="th">Percentage</th>
<th data-quarto-table-cell-role="th">Letter_Grade</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">62</th>
<td>M02</td>
<td>D</td>
<td>45</td>
<td>?</td>
<td>?</td>
<td>?</td>
<td>24</td>
<td>80.00%</td>
<td>B</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">64</th>
<td>M02</td>
<td>D</td>
<td>60</td>
<td>N</td>
<td>N</td>
<td>Y</td>
<td>24</td>
<td>80.00%</td>
<td>B</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>M01</td>
<td>A</td>
<td>20</td>
<td>N</td>
<td>N</td>
<td>Y</td>
<td>24</td>
<td>80.00%</td>
<td>B</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>M01</td>
<td>B</td>
<td>15</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>26</td>
<td>86.70%</td>
<td>B+</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">44</th>
<td>M02</td>
<td>B</td>
<td>45</td>
<td>Y</td>
<td>Y</td>
<td>Y</td>
<td>25</td>
<td>83.30%</td>
<td>B</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">26</th>
<td>M01</td>
<td>D</td>
<td>60</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td>19</td>
<td>63.30%</td>
<td>C-</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">39</th>
<td>M02</td>
<td>B</td>
<td>15</td>
<td>N</td>
<td>N</td>
<td>Y</td>
<td>19</td>
<td>63.30%</td>
<td>C-</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">46</th>
<td>M02</td>
<td>B</td>
<td>55</td>
<td>Y</td>
<td>N</td>
<td>N</td>
<td>17</td>
<td>56.70%</td>
<td>D</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">23</th>
<td>M01</td>
<td>D</td>
<td>35</td>
<td>?</td>
<td>?</td>
<td>?</td>
<td>13</td>
<td>43.30%</td>
<td>F</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">52</th>
<td>M02</td>
<td>C</td>
<td>40</td>
<td>Y</td>
<td>Y</td>
<td>N</td>
<td>16</td>
<td>53.30%</td>
<td>D</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>To follow along with the commands below, download the following scratch notebook to your <code>ist356</code> directory, then open it with VS Code:</p>
<p><a href="../assets/scratch-pandas-5.ipynb">Download scratch-pandas-5.ipynb</a></p>
<p>This has the <code>exams_data</code> URL in it.</p>
<section id="group-by" class="level2">
<h2 class="anchored" data-anchor-id="group-by">Group By</h2>
<p>With large data sets we frequently want to group common data together and summarize those groups in some way. For example, you might want to know:</p>
<ul>
<li>Average exam score by section</li>
<li>Number of students who took each exam</li>
<li>Average grade based on whether students studied in groups</li>
<li>Total completion time by letter grade</li>
</ul>
<p>The Pandas <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.groupby.html">groupby</a> method allows us to quickly group data like this. Using it involves two steps:</p>
<ol type="1">
<li>Run the <code>groupby</code> method on a dataframe, giving it a column or list of columns to group the data by.</li>
<li>The <code>groupby</code> method returns an <code>DataFrameGroupBy</code> object. On its own, this object isn’t terrible informative. To get something useful, we then use the aggregate method (<code>agg</code>) to summarize the grouped data and display it as a DataFrame. When aggregating the data, we need to provide the name of an operation (<code>sum, min, max, mean, std, quartile, count</code>) by which to summarizie the data.</li>
</ol>
<p>Here’s an example using our exams data:</p>
<div id="21c97340" class="cell" data-execution_count="2">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: Total number of exams take by section and the average score in each section:</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>exams_by_section <span class="op">=</span> exams.groupby(by<span class="op">=</span>[<span class="st">'Class_Section'</span>]).agg({ <span class="st">'Class_Section'</span>: <span class="st">'count'</span>, <span class="st">'Student_Score'</span>: <span class="st">'mean'</span> })</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>exams_by_section</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="2">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">Student_Score</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">M01</th>
<td>29</td>
<td>23.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M02</th>
<td>36</td>
<td>22.527778</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Here, we’ve chosen to group the exams by the class section. We’ve then produced a DataFrame in which the class sections are summarized by the number of students and their average score. The column names are a little confusing, however. Let’s rename them to make the output more readable:</p>
<div id="e29a02fa" class="cell" data-execution_count="3">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>exams_by_section <span class="op">=</span> exams.groupby(by<span class="op">=</span>[<span class="st">'Class_Section'</span>]).agg({ <span class="st">'Class_Section'</span>: <span class="st">'count'</span>, <span class="st">'Student_Score'</span>: <span class="st">'mean'</span> })</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>exams_by_section <span class="op">=</span> exams_by_section.rename(columns<span class="op">=</span>{<span class="st">'Class_Section'</span>: <span class="st">'Exam_Count'</span>, <span class="st">'Student_Score'</span>: <span class="st">'Average_Score'</span>})</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>exams_by_section</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="3">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Exam_Count</th>
<th data-quarto-table-cell-role="th">Average_Score</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">M01</th>
<td>29</td>
<td>23.000000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M02</th>
<td>36</td>
<td>22.527778</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Note that the grouped columns end up in the <a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.index.html">index</a> method to add the grouped columns back as a column:</p>
<div id="94afcc38" class="cell" data-execution_count="4">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>exams_by_section[<span class="st">'Class_Section'</span>] <span class="op">=</span> exams_by_section.index</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>exams_by_section</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="4">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Exam_Count</th>
<th data-quarto-table-cell-role="th">Average_Score</th>
<th data-quarto-table-cell-role="th">Class_Section</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">M01</th>
<td>29</td>
<td>23.000000</td>
<td>M01</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M02</th>
<td>36</td>
<td>22.527778</td>
<td>M02</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Code Challenge 6.1
</div>
</div>
<div class="callout-body-container callout-body">
<p>Create a Streamlit app that will load the exams csv file above and will allow the user to select one of the following: <code>Made_Own_Study_Guide</code>, <code>Did_Exam_Prep Assignment</code>, <code>Studied_In_Groups</code>. After the selection is made, display a dataframe that summarizes the count of students and the average student score for the selection.</p>
<p><em>Hint</em>: For offering the selection, use Streamlit’s <a href="https://docs.streamlit.io/develop/api-reference/widgets/st.selectbox">selectbox</a> method.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="af0190d7" class="cell" data-execution_count="5">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>st.title(<span class="st">"Exam Scores"</span>)</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>options <span class="op">=</span> [<span class="st">'Made_Own_Study_Guide'</span>, <span class="st">'Did_Exam_Prep Assignment'</span>, <span class="st">'Studied_In_Groups'</span>]</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>exams <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/mafudge/datasets/refs/heads/master/exam-scores/exam-scores.csv'</span>)</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>option <span class="op">=</span> st.selectbox(<span class="st">'Select Exam:'</span>, options)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> exams.groupby(by<span class="op">=</span>option).agg({<span class="st">'Class_Section'</span>: <span class="st">'count'</span>, <span class="st">'Student_Score'</span> :<span class="st">'mean'</span>})</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>summary_df <span class="op">=</span> summary_df.rename(columns<span class="op">=</span>{<span class="st">'Class_Section'</span>: <span class="st">'Student Count'</span>, <span class="st">'Student_Score'</span>: <span class="st">'Mean Score'</span>})</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>st.dataframe(summary_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="pivot-and-melt" class="level2">
<h2 class="anchored" data-anchor-id="pivot-and-melt">Pivot and Melt</h2>
<p>Pivot and melt are inverse operations:</p>
<ul>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.pivot.html">pivot</a> makes “long” data “wide” moving rows into columns.</li>
<li><a href="https://pandas.pydata.org/docs/reference/api/pandas.melt.html#pandas.melt%5D%60df.melt">melt</a> makes “wide” data “long” moving columns into rows. Basically, the opposite of <code>pivot</code>.</li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><p>These functions only move data, they are unable to summarize it.</p></li>
<li><p>The intersection of row/column must contain a single value. Multiple values under the same row/column will fail.</p></li>
</ul>
</div>
</div>
<p>To set this up this example from <code>exams</code> let’s create a dataframe that summarizes the data. We will add the index columns back to the dataframe for clarity. Please note this is not something that needs to be done typically. We are just re-using the dataset for this example. (In fact, the following block of code is basically creating a <em>pivot table</em> from the exams data. We’ll see how to create pivot tables using a much simpler way below.)</p>
<div id="a6be0e0c" class="cell" data-execution_count="6">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Get average scores by section and exam version:</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version <span class="op">=</span> exams.groupby(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>    by<span class="op">=</span>[<span class="st">'Class_Section'</span>, <span class="st">'Exam_Version'</span>]).agg({<span class="st">'Student_Score'</span>: <span class="st">'mean'</span>})</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="co"># add section and exam version back to dataframe</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version[<span class="st">'Class_Section'</span>] <span class="op">=</span> avg_scores_by_section_and_version.index.get_level_values(<span class="st">'Class_Section'</span>)</span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version[<span class="st">'Exam_Version'</span>] <span class="op">=</span> avg_scores_by_section_and_version.index.get_level_values(<span class="st">'Exam_Version'</span>)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># reset the index</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version <span class="op">=</span> avg_scores_by_section_and_version.reset_index(drop<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="co">#rename the Student_score to average score</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version <span class="op">=</span>  avg_scores_by_section_and_version.rename(columns<span class="op">=</span>{<span class="st">'Student_Score'</span>: <span class="st">'Average_Score'</span>})</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co">#reorder the columns</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version <span class="op">=</span> avg_scores_by_section_and_version[[<span class="st">'Class_Section'</span>, <span class="st">'Exam_Version'</span>, <span class="st">'Average_Score'</span>]]</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a><span class="co">#show</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>avg_scores_by_section_and_version</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">Average_Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>M01</td>
<td>A</td>
<td>25.428571</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>M01</td>
<td>B</td>
<td>23.571429</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>M01</td>
<td>C</td>
<td>23.714286</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>M01</td>
<td>D</td>
<td>19.750000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>M02</td>
<td>A</td>
<td>22.400000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>M02</td>
<td>B</td>
<td>23.222222</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>M02</td>
<td>C</td>
<td>21.777778</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>M02</td>
<td>D</td>
<td>22.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<section id="pivot" class="level3">
<h3 class="anchored" data-anchor-id="pivot">Pivot()</h3>
<p>Let’s pivot this data two different ways:</p>
<ul>
<li><code>exam_version_in_col</code> - a pivot where the exam version is in the column</li>
<li><code>class_section_in_col</code> - a pivot where the class section is in the column</li>
</ul>
<div id="2e8cf48a" class="cell" data-execution_count="7">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>exam_version_in_col <span class="op">=</span> avg_scores_by_section_and_version.pivot(</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'Class_Section'</span>, columns<span class="op">=</span><span class="st">'Exam_Version'</span>, values<span class="op">=</span><span class="st">'Average_Score'</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>exam_version_in_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">M01</th>
<td>25.428571</td>
<td>23.571429</td>
<td>23.714286</td>
<td>19.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M02</th>
<td>22.400000</td>
<td>23.222222</td>
<td>21.777778</td>
<td>22.75</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="6f515da3" class="cell" data-execution_count="8">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>class_section_in_col <span class="op">=</span> avg_scores_by_section_and_version.pivot(</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    index<span class="op">=</span><span class="st">'Exam_Version'</span>, columns<span class="op">=</span><span class="st">'Class_Section'</span>, values<span class="op">=</span><span class="st">'Average_Score'</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>class_section_in_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="7">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">M01</th>
<th data-quarto-table-cell-role="th">M02</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>25.428571</td>
<td>22.400000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">B</th>
<td>23.571429</td>
<td>23.222222</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">C</th>
<td>23.714286</td>
<td>21.777778</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">D</th>
<td>19.750000</td>
<td>22.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
<section id="melt" class="level3">
<h3 class="anchored" data-anchor-id="melt">Melt()</h3>
<p>We will now melt the data back into its original shape. Melt requires:</p>
<ul>
<li><code>id_vars=list</code> list of columns which remain in the melt</li>
<li><code>var_name=str</code> column name of the columns to unpivot</li>
<li><code>value_name</code> column name of the values to unpivot</li>
</ul>
<p>First, to get this this example to work, we need to add the index values as a column (here called <code>Class_Section</code>):</p>
<div id="a6fcbfc4" class="cell" data-execution_count="9">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>exam_version_in_col[<span class="st">'Class_Section'</span>] <span class="op">=</span> exam_version_in_col.index</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>melted1 <span class="op">=</span> exam_version_in_col.melt(id_vars<span class="op">=</span>[<span class="st">"Class_Section"</span>],</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>                                   var_name<span class="op">=</span><span class="st">"Exam_Version"</span>,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>                                   value_name<span class="op">=</span><span class="st">'Average_Score'</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>melted1</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">Average_Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>M01</td>
<td>A</td>
<td>25.428571</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>M02</td>
<td>A</td>
<td>22.400000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>M01</td>
<td>B</td>
<td>23.571429</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>M02</td>
<td>B</td>
<td>23.222222</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>M01</td>
<td>C</td>
<td>23.714286</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>M02</td>
<td>C</td>
<td>21.777778</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>M01</td>
<td>D</td>
<td>19.750000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>M02</td>
<td>D</td>
<td>22.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<p>Doing the same with the <code>class_section_in_col</code>:</p>
<div id="6d8e3a25" class="cell" data-execution_count="10">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>class_section_in_col[<span class="st">'Exam_Version'</span>] <span class="op">=</span> class_section_in_col.index</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>melted2 <span class="op">=</span> class_section_in_col.melt(id_vars<span class="op">=</span>[<span class="st">"Exam_Version"</span>],</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>                                    var_name<span class="op">=</span><span class="st">"Class_Section"</span>,</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>                                    value_name<span class="op">=</span><span class="st">'Average_Score'</span>)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>melted2</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">Average_Score</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">0</th>
<td>A</td>
<td>M01</td>
<td>25.428571</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">1</th>
<td>B</td>
<td>M01</td>
<td>23.571429</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">2</th>
<td>C</td>
<td>M01</td>
<td>23.714286</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">3</th>
<td>D</td>
<td>M01</td>
<td>19.750000</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">4</th>
<td>A</td>
<td>M02</td>
<td>22.400000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">5</th>
<td>B</td>
<td>M02</td>
<td>23.222222</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">6</th>
<td>C</td>
<td>M02</td>
<td>21.777778</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">7</th>
<td>D</td>
<td>M02</td>
<td>22.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
</section>
</section>
<section id="pivot_table" class="level2">
<h2 class="anchored" data-anchor-id="pivot_table">Pivot_table()</h2>
<p>The <code>pd.pivot_table()</code> function combines a <code>groupby()</code> with a <code>pivot()</code>. Its intended for when you need to pivot and aggregate in the pivot, avoiding a lot of extra code such as adding indexes as columns (as we had to above).</p>
<p>Here’s the examples above, but with a pivot_table on the original <code>exams</code>data. We can skip the processing building <code>avg_scores_by_section_and_version</code> because <code>pivot_table()</code> allows us to summarize data.</p>
<div id="b91e1e12" class="cell" data-execution_count="11">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>exam_version_in_col <span class="op">=</span> exams.pivot_table(index<span class="op">=</span><span class="st">'Class_Section'</span>,</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>                                        columns<span class="op">=</span><span class="st">'Exam_Version'</span>,</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>                                        values<span class="op">=</span><span class="st">'Student_Score'</span>,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>                                        aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>exam_version_in_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th">A</th>
<th data-quarto-table-cell-role="th">B</th>
<th data-quarto-table-cell-role="th">C</th>
<th data-quarto-table-cell-role="th">D</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">M01</th>
<td>25.428571</td>
<td>23.571429</td>
<td>23.714286</td>
<td>19.75</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">M02</th>
<td>22.400000</td>
<td>23.222222</td>
<td>21.777778</td>
<td>22.75</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div id="2af5d544" class="cell" data-execution_count="12">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>class_section_in_col <span class="op">=</span> exams.pivot_table(index<span class="op">=</span><span class="st">'Exam_Version'</span>,</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>                                         columns<span class="op">=</span><span class="st">'Class_Section'</span>,</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>                                         values<span class="op">=</span><span class="st">'Student_Score'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>                                         aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>class_section_in_col</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<div>


<table class="dataframe caption-top table table-sm table-striped small" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th">Class_Section</th>
<th data-quarto-table-cell-role="th">M01</th>
<th data-quarto-table-cell-role="th">M02</th>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">Exam_Version</th>
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<th data-quarto-table-cell-role="th">A</th>
<td>25.428571</td>
<td>22.400000</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">B</th>
<td>23.571429</td>
<td>23.222222</td>
</tr>
<tr class="odd">
<th data-quarto-table-cell-role="th">C</th>
<td>23.714286</td>
<td>21.777778</td>
</tr>
<tr class="even">
<th data-quarto-table-cell-role="th">D</th>
<td>19.750000</td>
<td>22.750000</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Code Challenge 6.2
</div>
</div>
<div class="callout-body-container callout-body">
<p>Let’s build an interactive pivot table in streamlit! Using the exams csv file from above:</p>
<ol type="1">
<li><p>Add a selection widget (use Steamlit’s <a href="https://docs.streamlit.io/develop/api-reference/widgets/st.selectbox">selectbox</a> method) that lets the user select one of the following fields to put in the row of the pivot table:</p>
<p>::: {#c33fc35d .cell execution_count=13} <code>{.python .cell-code}  fields = ['Class_Section', 'Exam_Version', 'Made_Own_Study_Guide', 'Did_Exam_Prep Assignment', 'Studied_In_Groups','Letter_Grade']</code> :::</p></li>
<li><p>Add another selection widget that allows the user to select which field to display in the columns. <em>Note:</em> you will need to remove the field the user selected for the row in the list of options, else you’ll get an error if they select the same field twice.</p></li>
<li><p>Create another selection widget that allows the user to select what data to populate the pivot table with. The pivot table should display the average of the selected value. The options for the displayed data should be:</p>
<div id="93b960cc" class="cell" data-execution_count="14">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>measures <span class="op">=</span> [<span class="st">'Completion_Time'</span>,<span class="st">'Student_Score'</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div></li>
<li><p>Build the pivot table dataframe from the inputs. Use the average for the <code>aggfunc</code></p></li>
<li><p>Display the pivot table.</p></li>
</ol>
<p>Here’s a screen shot of what your app should like:</p>
<p><img src="challenge-6_2-example.png" class="img-fluid"></p>
<p><strong>Bonus:</strong> Cache the exams data so that it is not reloaded every time you interact with the app! Refer back to the <a href="https://su-ist356-m003-fall-2025.github.io/course-home/03_ui/ui-2.html#session-state-helping-streamlit-remember-values">Session State section of the Streamlit tutorial</a> for help.</p>
<div class="callout callout-style-simple callout-caution no-icon callout-titled">
<div class="callout-header d-flex align-content-center collapsed" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon no-icon"></i>
</div>
<div class="callout-title-container flex-fill">
<span class="screen-reader-only">Caution</span>Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div id="2d85132a" class="cell" data-execution_count="15">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> streamlit <span class="im">as</span> st</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>st.title(<span class="st">"Exam Scores Pivot Table"</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="co"># load the data: we'll only do this once, then cache</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="st">'exams'</span> <span class="kw">not</span> <span class="kw">in</span> st.session_state:</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>    st.session_state.exams <span class="op">=</span> pd.read_csv(<span class="st">'https://raw.githubusercontent.com/mafudge/datasets/refs/heads/master/exam-scores/exam-scores.csv'</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the options</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>fields <span class="op">=</span> [ <span class="st">'Class_Section'</span>, <span class="st">'Exam_Version'</span>, <span class="st">'Made_Own_Study_Guide'</span>, <span class="st">'Did_Exam_Prep Assignment'</span>, <span class="st">'Studied_In_Groups'</span>,<span class="st">'Letter_Grade'</span>]</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>measures <span class="op">=</span> [<span class="st">'Student_Score'</span>, <span class="st">'Completion_Time'</span>]</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>row <span class="op">=</span> st.selectbox(<span class="st">'Display in Row:'</span>, fields)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>fields.remove(row)</span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>col <span class="op">=</span> st.selectbox(<span class="st">'Display in Column:'</span>, fields)</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>value <span class="op">=</span> st.selectbox(<span class="st">'Display Average of:'</span>, measures)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>pivot_df <span class="op">=</span> st.session_state.exams.pivot_table(index<span class="op">=</span>row, columns<span class="op">=</span>col, values<span class="op">=</span>value, aggfunc<span class="op">=</span><span class="st">'mean'</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>st.dataframe(pivot_df)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</div>
</div>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("enter_gitHub_pages_URL_here");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../04_data_wrangling/pandas-4.html" class="pagination-link" aria-label="5. Basic data cleaning with Pandas">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">5. Basic data cleaning with Pandas</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../05_web_apis/index.html" class="pagination-link" aria-label="5. Web APIs">
        <span class="nav-page-text">5. Web APIs</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Adapted from the <a href="https://opensource.syracuse.edu/">Syracuse University Open Source Program Office’s</a> <a href="https://github.com/SU-OSPO/workshop-template">workshop template</a>.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ❤️ and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>